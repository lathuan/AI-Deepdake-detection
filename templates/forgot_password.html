<!DOCTYPE html>
<html>
<head>
    <title>Forgot Password - Deepfake Detection</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Background Glow Effects -->
    <div class="bg-glow main-glow"></div>
    <div class="bg-glow top-right-glow"></div>
    <div class="bg-glow bottom-left-glow"></div>
    
    <div class="forgot-container">
        <div class="forgot-card">
            <div class="forgot-header">
                <div class="forgot-logo">DeepCheck</div>
                <h1 class="forgot-title">Reset Your Password</h1>
                <p class="forgot-subtitle">Enter your email address and we'll send you a link to reset your password.</p>
            </div>

            <!-- Flash Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="reset-status flash-{{ category }} show">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <!-- Success State (hidden by default) -->
            <div id="successState" class="reset-success-state" style="display: none;">
                <div class="success-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <p class="success-message">
                    <strong>Check your email!</strong><br>
                    We've sent a password reset link to your email address. Please check your inbox and follow the instructions.
                </p>
                <a href="/login" class="back-link">Return to Login</a>
            </div>

            <!-- Reset Form -->
            <form id="resetForm" method="POST" class="forgot-form">
                <div class="forgot-form-group">
                    <label class="forgot-label">Email Address</label>
                    <input type="email" name="email" class="forgot-input" placeholder="Enter your registered email" required>
                </div>

                <button type="submit" class="btn-reset" id="resetBtn">
                    <span id="btnText">Send Reset Link</span>
                </button>
            </form>

            <!-- Instructions -->
            <div class="reset-instructions">
                <div class="instructions-title">Instructions:</div>
                <ul class="instructions-list">
                    <li>Enter the email address associated with your account</li>
                    <li>Check your email for the reset link (check spam folder too)</li>
                    <li>The link will expire in 1 hour for security reasons</li>
                    <li>Create a strong new password with at least 8 characters</li>
                </ul>
            </div>

            <!-- Back Link -->
            <div class="forgot-links">
                <a href="/login" class="back-link">Back to Login</a>
            </div>
        </div>
    </div>

    <script>
        // Form submission handling
        document.getElementById('resetForm').addEventListener('submit', function(e) {
            const btn = document.getElementById('resetBtn');
            const btnText = document.getElementById('btnText');
            
            // Add loading state
            btn.classList.add('btn-loading');
            btn.disabled = true;
            btnText.textContent = 'Sending...';
            
            // Simulate success after 2 seconds (in real app, remove this)
            setTimeout(() => {
                // Only show success if no server-side errors
                if (!document.querySelector('.flash-error')) {
                    document.getElementById('resetForm').style.display = 'none';
                    document.getElementById('successState').style.display = 'block';
                    document.querySelector('.reset-instructions').style.display = 'none';
                }
                
                // Reset button
                btn.classList.remove('btn-loading');
                btn.disabled = false;
                btnText.textContent = 'Send Reset Link';
            }, 2000);
        });

        // Auto-hide flash messages after 5 seconds
        setTimeout(() => {
            const flashMessages = document.querySelectorAll('.reset-status');
            flashMessages.forEach(msg => {
                msg.style.opacity = '0';
                msg.style.transition = 'opacity 0.5s';
                setTimeout(() => msg.remove(), 500);
            });
        }, 5000);

        // Theme detection
        const currentTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', currentTheme);
    </script>
</body>
</html>